#!/usr/bin/env node
var args = require('minimist')(process.argv);
var tmuxtdd = require('..');
var path = require('path');
var fs = require('fs');

function run(watch, testCmd) {
  tmuxtdd.startRunner(watch, testCmd);
}

function help() {
  fs.createReadStream(path.resolve(__dirname, '..', 'help.txt'))
  .pipe(process.stdout)
  .on('done', process.exit)
}

function main(args) {
  if (args.h || args.help) {
    return help();
  } else if (args.status) {
    return tmuxtdd.printStatus()
  } else switch (args._[2]) {
    case 'tmuxtdd-conf':
      return console.log(tmuxtdd.tmuxConf);
    case 'run':
      return run(args.w || args.watch, args.c || args.cmd);
    default:
      return help();
  }
}

main(args);
